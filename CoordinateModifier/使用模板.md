# 坐标系修改插件使用模板

## 插件架构说明

插件采用分层结构，在机器人编程界面中会按以下层次显示：

```
CALL_SERVICE CM
  ├─ SetTF*          (工具坐标系)
  │   ├─ SetTFid,x,y,z,a,b,c             (直接输入，无括号)
  │   ├─ SetTFid,param_name,R寄存器编号   (R寄存器输入，无括号)
  │   └─ SetTFid,PR寄存器编号             (PR寄存器输入，无括号)
  └─ SetUF*          (用户坐标系)
      ├─ SetUFid,x,y,z,a,b,c             (直接输入，无括号)
      ├─ SetUFid,param_name,R寄存器编号   (R寄存器输入，无括号)
      └─ SetUFid,PR寄存器编号             (PR寄存器输入，无括号)
```

## 一、工具坐标系（TF）使用模板

### 场景1：直接输入完整参数

**模板（无括号）：**
```
CALL_SERVICE CM SetTF坐标系ID,X坐标,Y坐标,Z坐标,A角度,B角度,C角度
```

**示例：**
```
// 修改工具坐标系1：位置(100, 200, 300)，角度(1, 2, 3)
CALL_SERVICE CM SetTF1,100.000,200.000,300.000,1.000,2.000,3.000

// 修改工具坐标系2：只设置位置，角度为0
CALL_SERVICE CM SetTF2,150.000,250.000,350.000,0.000,0.000,0.000
```

### 场景2：从R寄存器输入单个参数

**模板（无括号）：**
```
CALL_SERVICE CM SetTF坐标系ID,参数名称,R寄存器编号
```

**参数名称可选：** `X`, `Y`, `Z`, `A`, `B`, `C`

**示例：**
```
// 从R寄存器5读取值，更新工具坐标系1的X坐标
CALL_SERVICE CM SetTF1,X,R5

// 从R寄存器10读取值，更新工具坐标系1的Y坐标
CALL_SERVICE CM SetTF1,Y,R10

// 从R寄存器15读取值，更新工具坐标系1的A角度
CALL_SERVICE CM SetTF1,A,R15
```

### 场景3：从PR寄存器输入完整参数

**模板（无括号）：**
```
CALL_SERVICE CM SetTF坐标系ID,PR寄存器编号
```

**示例：**
```
// 从PR寄存器5读取完整的XYZABC值，更新工具坐标系1
CALL_SERVICE CM SetTF1,PR5

// 从PR寄存器10读取完整的XYZABC值，更新工具坐标系2
CALL_SERVICE CM SetTF2,PR10
```

## 二、用户坐标系（UF）使用模板

### 场景1：直接输入完整参数

**模板（无括号）：**
```
CALL_SERVICE CM SetUF坐标系ID,X坐标,Y坐标,Z坐标,A角度,B角度,C角度
```

**示例：**
```
// 修改用户坐标系1：位置(50, 100, 150)，角度(45, 30, 60)
CALL_SERVICE CM SetUF1,50.000,100.000,150.000,45.000,30.000,60.000

// 修改用户坐标系2：只设置位置，角度为0
CALL_SERVICE CM SetUF2,200.000,300.000,400.000,0.000,0.000,0.000
```

### 场景2：从R寄存器输入单个参数

**模板（无括号）：**
```
CALL_SERVICE CM SetUF坐标系ID,参数名称,R寄存器编号
```

**示例：**
```
// 从R寄存器5读取值，更新用户坐标系1的X坐标
CALL_SERVICE CM SetUF1,X,R5

// 从R寄存器20读取值，更新用户坐标系1的Z坐标
CALL_SERVICE CM SetUF1,Z,R20

// 从R寄存器25读取值，更新用户坐标系1的B角度
CALL_SERVICE CM SetUF1,B,R25
```

### 场景3：从PR寄存器输入完整参数

**模板（无括号）：**
```
CALL_SERVICE CM SetUF坐标系ID,PR寄存器编号
```

**示例：**
```
// 从PR寄存器5读取完整的XYZABC值，更新用户坐标系1
CALL_SERVICE CM SetUF1,PR5

// 从PR寄存器20读取完整的XYZABC值，更新用户坐标系2
CALL_SERVICE CM SetUF2,PR20
```

## 三、完整程序示例

### 示例1：修改工具坐标系并移动到该坐标系

```
// 设置工具坐标系1的位置和角度
CALL_SERVICE CM SetTF1,100.000,200.000,300.000,0.000,0.000,0.000

// 使用工具坐标系1进行运动
MOVJ P1 TOOL=1
```

### 示例2：从R寄存器更新工具坐标系的X坐标

```
// 假设R寄存器5中存储了新的X坐标值
// 从R寄存器5读取值，更新工具坐标系1的X坐标
CALL_SERVICE CM SetTF1,X,R5

// 使用更新后的工具坐标系1
MOVJ P2 TOOL=1
```

### 示例3：从PR寄存器更新用户坐标系

```
// 假设PR寄存器5中存储了完整的位姿数据
// 从PR寄存器5读取完整的XYZABC值，更新用户坐标系1
CALL_SERVICE CM SetUF1,PR5

// 使用更新后的用户坐标系1
MOVJ P3 FRAME=1
```

### 示例4：逐步更新坐标系的各个参数

```
// 步骤1：从R寄存器5更新X坐标
CALL_SERVICE CM SetTF1,X,R5

// 步骤2：从R寄存器6更新Y坐标
CALL_SERVICE CM SetTF1,Y,R6

// 步骤3：从R寄存器7更新Z坐标
CALL_SERVICE CM SetTF1,Z,R7

// 步骤4：从R寄存器8更新A角度
CALL_SERVICE CM SetTF1,A,R8

// 步骤5：从R寄存器9更新B角度
CALL_SERVICE CM SetTF1,B,R9

// 步骤6：从R寄存器10更新C角度
CALL_SERVICE CM SetTF1,C,R10
```

## 四、参数说明速查表

### 坐标系ID（id）
| 值 | 说明 |
|---|---|
| 1-30 | 可用的坐标系ID（0是基础坐标系，不可修改） |

### 参数名称（param_name）
| 值 | 参数 | 单位 | 说明 |
|---|---|---|---|
| X | X坐标 | mm | X轴位置 |
| Y | Y坐标 | mm | Y轴位置 |
| Z | Z坐标 | mm | Z轴位置 |
| A | A角度 | 度 | 绕X轴旋转角度（欧拉角） |
| B | B角度 | 度 | 绕Y轴旋转角度（欧拉角） |
| C | C角度 | 度 | 绕Z轴旋转角度（欧拉角） |

### 数据精度
- **位置精度**：保留3位小数（单位：mm）
- **角度精度**：保留3位小数（单位：度）

## 五、注意事项

1. **参数顺序**：所有参数都是位置参数，必须按顺序传递
2. **坐标系类型**：SetTF用于工具坐标系，SetUF用于用户坐标系
3. **数据精度**：所有数值自动保留三位小数
4. **坐标系ID范围**：1-30（0是基础坐标系，不可修改）
5. **长连接机制**：插件使用长连接，不需要手动创建连接

## 六、快速参考

### 工具坐标系（TF）
```
// 直接输入（无括号）
CALL_SERVICE CM SetTF坐标系ID,x,y,z,a,b,c

// R寄存器输入（无括号）
CALL_SERVICE CM SetTF坐标系ID,参数名称,R寄存器编号

// PR寄存器输入（无括号）
CALL_SERVICE CM SetTF坐标系ID,PR寄存器编号
```

### 用户坐标系（UF）
```
// 直接输入（无括号）
CALL_SERVICE CM SetUF坐标系ID,x,y,z,a,b,c

// R寄存器输入（无括号）
CALL_SERVICE CM SetUF坐标系ID,参数名称,R寄存器编号

// PR寄存器输入（无括号）
CALL_SERVICE CM SetUF坐标系ID,PR寄存器编号
```
