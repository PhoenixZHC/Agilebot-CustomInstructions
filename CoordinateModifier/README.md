# 用户自定义指令插件 (CM) 使用文档

## 概述

CM（Custom Module）是一个用户自定义指令插件，为捷勃特机器人提供了一系列实用的自定义指令，包括工具坐标系（TF）和用户坐标系（UF）的设置功能，以及R寄存器的自增自减操作。

本插件通过封装常用的机器人操作，简化了编程流程，提高了开发效率。所有指令都经过完整的参数验证和错误处理，确保操作的可靠性和安全性。

---

## 兼容SDK版本说明

本插件使用 **PYTHON_v1.7.1.3** 开发，请确保您的开发环境与此版本兼容。

---

## 打包说明

插件开发完毕后，需要使用捷勃特插件打包工具进行打包。详细的打包与安装说明请参考：

[打包与安装文档](https://dev.sh-agilebot.com/docs/extension/zh/02-development/04-package.html)

---

## 功能列表

插件提供以下8个自定义指令：

1. **SetTF** - 设置工具坐标系参数（直接数值）
2. **SetUF** - 设置用户坐标系参数（直接数值）
3. **SetTF_R** - 从R寄存器读取值设置工具坐标系参数
4. **SetUF_R** - 从R寄存器读取值设置用户坐标系参数
5. **SetTF_PR** - 从PR寄存器读取完整位姿设置工具坐标系
6. **SetUF_PR** - 从PR寄存器读取完整位姿设置用户坐标系
7. **Incr** - R寄存器自增
8. **Decr** - R寄存器自减

---

## 指令详细说明

### 1. SetTF - 设置工具坐标系参数（直接数值）

直接通过数值设置工具坐标系的指定参数。

**参数：**
- `ID` (int): 工具坐标系ID号（1-30，0是基础坐标系不可修改）
- `Pos` (int): 位置参数编号（1-6）
  - 1: X坐标（单位：mm）
  - 2: Y坐标（单位：mm）
  - 3: Z坐标（单位：mm）
  - 4: A角度（单位：度）
  - 5: B角度（单位：度）
  - 6: C角度（单位：度）
- `Value` (float): 参数值（数值类型）

**示例：**
```
CALL_SERVICE CM, Set TF, ID=1, Pos=1, Value=111.11
```
将工具坐标系1的X坐标设置为111.11mm

**使用场景：**
- 直接设置工具坐标系的某个参数
- 精确调整工具位置或姿态
- 程序化配置工具坐标系

---

### 2. SetUF - 设置用户坐标系参数（直接数值）

直接通过数值设置用户坐标系的指定参数。

**参数：**
- `ID` (int): 用户坐标系ID号（1-30，0是基础坐标系不可修改）
- `Pos` (int): 位置参数编号（1-6）
  - 1: X坐标（单位：mm）
  - 2: Y坐标（单位：mm）
  - 3: Z坐标（单位：mm）
  - 4: A角度（单位：度）
  - 5: B角度（单位：度）
  - 6: C角度（单位：度）
- `Value` (float): 参数值（数值类型）

**示例：**
```
CALL_SERVICE CM, SetUF, ID=1, Pos=1, Value=222.354
```
将用户坐标系1的X坐标设置为222.354mm

**使用场景：**
- 直接设置用户坐标系的某个参数
- 调整工件坐标系位置或姿态
- 程序化配置用户坐标系

---

### 3. SetTF_R - 从R寄存器读取值设置工具坐标系参数

从指定的R寄存器读取数值，并设置到工具坐标系的指定参数。

**参数：**
- `ID` (int): 工具坐标系ID号（1-30）
- `Pos` (int): 位置参数编号（1-6）
  - 1: X坐标
  - 2: Y坐标
  - 3: Z坐标
  - 4: A角度
  - 5: B角度
  - 6: C角度
- `R_ID` (int): R寄存器编号

**示例：**
```
CALL_SERVICE CM, Set TF_R, ID=3, Pos=1, R_ID=1
```
从R寄存器1读取值，设置到工具坐标系3的X坐标

**使用场景：**
- 通过R寄存器动态设置工具坐标系参数
- 实现参数的可配置化
- 与其他程序模块的数据交互

---

### 4. SetUF_R - 从R寄存器读取值设置用户坐标系参数

从指定的R寄存器读取数值，并设置到用户坐标系的指定参数。

**参数：**
- `ID` (int): 用户坐标系ID号（1-30）
- `Pos` (int): 位置参数编号（1-6）
  - 1: X坐标
  - 2: Y坐标
  - 3: Z坐标
  - 4: A角度
  - 5: B角度
  - 6: C角度
- `R_ID` (int): R寄存器编号

**示例：**
```
CALL_SERVICE CM, SetUF_R, ID=3, Pos=1, R_ID=1
```
从R寄存器1读取值，设置到用户坐标系3的X坐标

**使用场景：**
- 通过R寄存器动态设置用户坐标系参数
- 实现参数的可配置化
- 与其他程序模块的数据交互

---

### 5. SetTF_PR - 从PR寄存器读取完整位姿设置工具坐标系

从指定的PR寄存器读取完整的位姿信息（X、Y、Z、A、B、C），并一次性设置到工具坐标系。

**参数：**
- `ID` (int): 工具坐标系ID号（1-30）
- `PR_ID` (int): PR寄存器编号

**示例：**
```
CALL_SERVICE CM, Set TF_PR, ID=2, PR_ID=1
```
从PR寄存器1读取完整位姿，设置到工具坐标系2

**使用场景：**
- 从PR寄存器复制完整位姿到工具坐标系
- 批量设置工具坐标系的所有参数
- 保存和恢复工具坐标系配置

**注意事项：**
- PR寄存器必须包含有效的位姿数据
- 位姿数据会自动保留三位小数精度

---

### 6. SetUF_PR - 从PR寄存器读取完整位姿设置用户坐标系

从指定的PR寄存器读取完整的位姿信息，并一次性设置到用户坐标系。

**参数：**
- `ID` (int): 用户坐标系ID号（1-30）
- `PR_ID` (int): PR寄存器编号

**示例：**
```
CALL_SERVICE CM, SetUF_PR, ID=2, PR_ID=2
```
从PR寄存器2读取完整位姿，设置到用户坐标系2

**使用场景：**
- 从PR寄存器复制完整位姿到用户坐标系
- 批量设置用户坐标系的所有参数
- 保存和恢复用户坐标系配置

**注意事项：**
- PR寄存器必须包含有效的位姿数据
- 位姿数据会自动保留三位小数精度

---

### 7. Incr - R寄存器自增

将指定R寄存器的值增加指定的步长。

**参数：**
- `R_ID` (int): R寄存器编号
- `Step` (float): 自增步长，默认为1.0

**示例：**
```
CALL_SERVICE CM, Incr, R_ID=2, Step=1
```
R寄存器2的值自增1

**使用场景：**
- 计数器功能
- 循环递增操作
- 步进控制
- 程序流程控制

---

### 8. Decr - R寄存器自减

将指定R寄存器的值减少指定的步长。

**参数：**
- `R_ID` (int): R寄存器编号
- `Step` (float): 自减步长，默认为1.0

**示例：**
```
CALL_SERVICE CM, Decr, R_ID=1, Step=1
```
R寄存器1的值自减1

**使用场景：**
- 倒计时功能
- 循环递减操作
- 反向步进控制
- 程序流程控制

---

## 更新日志

### V1.0 (2025-12-18)
- 初始版本发布
- 支持工具坐标系（TF）和用户坐标系（UF）的直接设置
- 支持从R寄存器和PR寄存器读取值设置坐标系
- 支持R寄存器自增功能（Incr）
- 支持R寄存器自减功能（Decr）
