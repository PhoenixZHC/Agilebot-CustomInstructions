# 坐标系修改插件使用模板

## 插件架构说明

插件采用分层结构（方案B：单参数函数），在机器人编程界面中会按以下层次显示：

```
CALL_SERVICE CM
  ├─ SetTF*          (工具坐标系)
  │   ├─ SetTF_X*    (设置X坐标，2个参数)
  │   ├─ SetTF_Y*    (设置Y坐标，2个参数)
  │   ├─ SetTF_Z*    (设置Z坐标，2个参数)
  │   ├─ SetTF_A*    (设置A角度，2个参数)
  │   ├─ SetTF_B*    (设置B角度，2个参数)
  │   ├─ SetTF_C*    (设置C角度，2个参数)
  │   ├─ SetTFR*      (从R寄存器输入，3个参数)
  │   └─ SetTFPR*     (从PR寄存器输入，2个参数)
  └─ SetUF*          (用户坐标系)
      ├─ SetUF_X*    (设置X坐标，2个参数)
      ├─ SetUF_Y*    (设置Y坐标，2个参数)
      ├─ SetUF_Z*    (设置Z坐标，2个参数)
      ├─ SetUF_A*    (设置A角度，2个参数)
      ├─ SetUF_B*    (设置B角度，2个参数)
      ├─ SetUF_C*    (设置C角度，2个参数)
      ├─ SetUFR*      (从R寄存器输入，3个参数)
      └─ SetUFPR*     (从PR寄存器输入，2个参数)
```

## 一、工具坐标系（TF）使用模板

### 场景1：单参数输入（每个函数只有2个参数）

**模板（无括号）：**
```
CALL_SERVICE CM SetTF_参数名坐标系ID,值
```

**参数名可选：** `X`, `Y`, `Z`, `A`, `B`, `C`

**示例：**

示例1：修改工具坐标系1的完整参数（需要调用6个函数）
```
// 设置位置
CALL_SERVICE CM SetTF_X1,100.000
CALL_SERVICE CM SetTF_Y1,200.000
CALL_SERVICE CM SetTF_Z1,300.000
// 设置角度
CALL_SERVICE CM SetTF_A1,1.000
CALL_SERVICE CM SetTF_B1,2.000
CALL_SERVICE CM SetTF_C1,3.000
```

示例2：只修改X坐标
```
CALL_SERVICE CM SetTF_X1,150.000
```

示例3：只修改A角度
```
CALL_SERVICE CM SetTF_A1,45.000
```

### 场景2：从R寄存器输入单个参数

**模板（无括号）：**
```
CALL_SERVICE CM SetTFR坐标系ID,参数名称,R寄存器编号
```

**参数名称可选：** `X`, `Y`, `Z`, `A`, `B`, `C`

**示例：**
```
// 从R寄存器5读取值，更新工具坐标系1的X坐标
CALL_SERVICE CM SetTFR1,X,R5

// 从R寄存器10读取值，更新工具坐标系1的Y坐标
CALL_SERVICE CM SetTFR1,Y,R10

// 从R寄存器15读取值，更新工具坐标系1的A角度
CALL_SERVICE CM SetTFR1,A,R15
```

### 场景3：从PR寄存器输入完整参数

**模板（无括号）：**
```
CALL_SERVICE CM SetTFPR坐标系ID,PR寄存器编号
```

**示例：**
```
// 从PR寄存器5读取完整的XYZABC值，更新工具坐标系1
CALL_SERVICE CM SetTFPR1,PR5

// 从PR寄存器10读取完整的XYZABC值，更新工具坐标系2
CALL_SERVICE CM SetTFPR2,PR10
```

## 二、用户坐标系（UF）使用模板

### 场景1：单参数输入（每个函数只有2个参数）

**模板（无括号）：**
```
CALL_SERVICE CM SetUF_参数名坐标系ID,值
```

**参数名可选：** `X`, `Y`, `Z`, `A`, `B`, `C`

**示例：**

示例1：修改用户坐标系1的完整参数（需要调用6个函数）
```
// 设置位置
CALL_SERVICE CM SetUF_X1,50.000
CALL_SERVICE CM SetUF_Y1,100.000
CALL_SERVICE CM SetUF_Z1,150.000
// 设置角度
CALL_SERVICE CM SetUF_A1,45.000
CALL_SERVICE CM SetUF_B1,30.000
CALL_SERVICE CM SetUF_C1,60.000
```

示例2：只修改X坐标
```
CALL_SERVICE CM SetUF_X1,200.000
```

示例3：只修改A角度
```
CALL_SERVICE CM SetUF_A1,90.000
```

### 场景2：从R寄存器输入单个参数

**模板（无括号）：**
```
CALL_SERVICE CM SetUFR坐标系ID,参数名称,R寄存器编号
```

**示例：**
```
// 从R寄存器5读取值，更新用户坐标系1的X坐标
CALL_SERVICE CM SetUFR1,X,R5

// 从R寄存器20读取值，更新用户坐标系1的Z坐标
CALL_SERVICE CM SetUFR1,Z,R20

// 从R寄存器25读取值，更新用户坐标系1的B角度
CALL_SERVICE CM SetUFR1,B,R25
```

### 场景3：从PR寄存器输入完整参数

**模板（无括号）：**
```
CALL_SERVICE CM SetUFPR坐标系ID,PR寄存器编号
```

**示例：**
```
// 从PR寄存器5读取完整的XYZABC值，更新用户坐标系1
CALL_SERVICE CM SetUFPR1,PR5

// 从PR寄存器20读取完整的XYZABC值，更新用户坐标系2
CALL_SERVICE CM SetUFPR2,PR20
```

## 三、完整程序示例

### 示例1：修改工具坐标系并移动到该坐标系

```
// 设置工具坐标系1的位置和角度（需要调用6个函数）
CALL_SERVICE CM SetTF_X1,100.000
CALL_SERVICE CM SetTF_Y1,200.000
CALL_SERVICE CM SetTF_Z1,300.000
CALL_SERVICE CM SetTF_A1,0.000
CALL_SERVICE CM SetTF_B1,0.000
CALL_SERVICE CM SetTF_C1,0.000

// 使用工具坐标系1进行运动
MOVJ P1 TOOL=1
```

### 示例2：从R寄存器更新工具坐标系的X坐标

```
// 假设R寄存器5中存储了新的X坐标值
// 从R寄存器5读取值，更新工具坐标系1的X坐标
CALL_SERVICE CM SetTFR1,X,R5

// 使用更新后的工具坐标系1
MOVJ P2 TOOL=1
```

### 示例3：从PR寄存器更新用户坐标系

```
// 假设PR寄存器5中存储了完整的位姿数据
// 从PR寄存器5读取完整的XYZABC值，更新用户坐标系1
CALL_SERVICE CM SetUFPR1,PR5

// 使用更新后的用户坐标系1
MOVJ P3 FRAME=1
```

### 示例4：逐步更新坐标系的各个参数（使用单参数函数）

```
// 步骤1：直接设置X坐标
CALL_SERVICE CM SetTF_X1,100.000

// 步骤2：直接设置Y坐标
CALL_SERVICE CM SetTF_Y1,200.000

// 步骤3：直接设置Z坐标
CALL_SERVICE CM SetTF_Z1,300.000

// 步骤4：直接设置A角度
CALL_SERVICE CM SetTF_A1,45.000

// 步骤5：直接设置B角度
CALL_SERVICE CM SetTF_B1,30.000

// 步骤6：直接设置C角度
CALL_SERVICE CM SetTF_C1,60.000
```

### 示例5：从R寄存器逐步更新坐标系的各个参数

```
// 步骤1：从R寄存器5更新X坐标
CALL_SERVICE CM SetTFR1,X,R5

// 步骤2：从R寄存器6更新Y坐标
CALL_SERVICE CM SetTFR1,Y,R6

// 步骤3：从R寄存器7更新Z坐标
CALL_SERVICE CM SetTFR1,Z,R7

// 步骤4：从R寄存器8更新A角度
CALL_SERVICE CM SetTFR1,A,R8

// 步骤5：从R寄存器9更新B角度
CALL_SERVICE CM SetTFR1,B,R9

// 步骤6：从R寄存器10更新C角度
CALL_SERVICE CM SetTFR1,C,R10
```

## 四、参数说明速查表

### 坐标系ID（id）
| 值 | 说明 |
|---|---|
| 1-30 | 可用的坐标系ID（0是基础坐标系，不可修改） |

### 参数名称（param_name）
| 值 | 参数 | 单位 | 说明 |
|---|---|---|---|
| X | X坐标 | mm | X轴位置 |
| Y | Y坐标 | mm | Y轴位置 |
| Z | Z坐标 | mm | Z轴位置 |
| A | A角度 | 度 | 绕X轴旋转角度（欧拉角） |
| B | B角度 | 度 | 绕Y轴旋转角度（欧拉角） |
| C | C角度 | 度 | 绕Z轴旋转角度（欧拉角） |

### 数据精度
- **位置精度**：保留3位小数（单位：mm）
- **角度精度**：保留3位小数（单位：度）

## 五、注意事项

1. **参数顺序**：所有参数都是位置参数，必须按顺序传递
2. **坐标系类型**：SetTF用于工具坐标系，SetUF用于用户坐标系
3. **数据精度**：所有数值自动保留三位小数
4. **坐标系ID范围**：1-30（0是基础坐标系，不可修改）
5. **长连接机制**：插件使用长连接，不需要手动创建连接

## 六、快速参考

### 工具坐标系（TF）
```
// 单参数输入（每个函数只有2个参数，无括号）
CALL_SERVICE CM SetTF_X坐标系ID,值
CALL_SERVICE CM SetTF_Y坐标系ID,值
CALL_SERVICE CM SetTF_Z坐标系ID,值
CALL_SERVICE CM SetTF_A坐标系ID,值
CALL_SERVICE CM SetTF_B坐标系ID,值
CALL_SERVICE CM SetTF_C坐标系ID,值

// R寄存器输入（无括号）
CALL_SERVICE CM SetTFR坐标系ID,参数名称,R寄存器编号

// PR寄存器输入（无括号）
CALL_SERVICE CM SetTFPR坐标系ID,PR寄存器编号
```

### 用户坐标系（UF）
```
// 单参数输入（每个函数只有2个参数，无括号）
CALL_SERVICE CM SetUF_X坐标系ID,值
CALL_SERVICE CM SetUF_Y坐标系ID,值
CALL_SERVICE CM SetUF_Z坐标系ID,值
CALL_SERVICE CM SetUF_A坐标系ID,值
CALL_SERVICE CM SetUF_B坐标系ID,值
CALL_SERVICE CM SetUF_C坐标系ID,值

// R寄存器输入（无括号）
CALL_SERVICE CM SetUFR坐标系ID,参数名称,R寄存器编号

// PR寄存器输入（无括号）
CALL_SERVICE CM SetUFPR坐标系ID,PR寄存器编号
```
